# RD-Plan Makefile
# Vereinfacht Entwicklungs- und Deployment-Workflows

.PHONY: help build dev sync quick-sync release clean install storage-check storage-cleanup

# Standardziel
help:
	@echo "RD-Plan Entwicklungs-Commands:"
	@echo ""
	@echo "  make build          - Baut die Entwicklungsversion"
	@echo "  make dev            - Startet die Entwicklungsversion"
	@echo "  make install        - Installiert Dependencies"
	@echo "  make sync           - VollstÃ¤ndige Sync zu Beta + GitHub"
	@echo "  make quick-sync     - Schnelle Sync ohne BestÃ¤tigung"
	@echo "  make release        - Erstellt Release-Build"
	@echo "  make clean          - AufrÃ¤umen (node_modules, dist)"
	@echo "  make storage-check  - PrÃ¼ft GitHub Storage-Nutzung"
	@echo "  make storage-cleanup- Bereinigt GitHub Artifacts"
	@echo ""

# Verzeichnisse
DEV_DIR = rd-plan
BETA_DIR = rd-plan-beta

# Build Development
build:
	@echo "ğŸ”¨ Baue Entwicklungsversion..."
	cd $(DEV_DIR) && npm run build

# Start Development
dev:
	@echo "ğŸš€ Starte Entwicklungsversion..."
	cd $(DEV_DIR) && npm start

# Install Dependencies
install:
	@echo "ğŸ“¦ Installiere Dependencies..."
	cd $(DEV_DIR) && npm install
	@if [ -d "$(BETA_DIR)" ]; then \
		echo "ğŸ“¦ Installiere Beta Dependencies..."; \
		cd $(BETA_DIR) && npm install; \
	fi

# Full Sync to Beta
sync:
	@echo "ğŸ”„ Starte vollstÃ¤ndige Synchronisation..."
	chmod +x sync-to-beta.sh
	./sync-to-beta.sh

# Quick Sync
quick-sync:
	@echo "âš¡ Starte schnelle Synchronisation..."
	chmod +x quick-sync.sh
	./quick-sync.sh

# Release Build
release: build sync
	@echo "ğŸ‰ Release erstellt und synchronisiert!"

# Clean
clean:
	@echo "ğŸ§¹ RÃ¤ume auf..."
	@if [ -d "$(DEV_DIR)/node_modules" ]; then \
		echo "ğŸ—‘ï¸  Entferne $(DEV_DIR)/node_modules..."; \
		rm -rf $(DEV_DIR)/node_modules; \
	fi
	@if [ -d "$(DEV_DIR)/dist" ]; then \
		echo "ğŸ—‘ï¸  Entferne $(DEV_DIR)/dist..."; \
		rm -rf $(DEV_DIR)/dist; \
	fi
	@if [ -d "$(BETA_DIR)/node_modules" ]; then \
		echo "ğŸ—‘ï¸  Entferne $(BETA_DIR)/node_modules..."; \
		rm -rf $(BETA_DIR)/node_modules; \
	fi
	@if [ -d "$(BETA_DIR)/dist" ]; then \
		echo "ğŸ—‘ï¸  Entferne $(BETA_DIR)/dist..."; \
		rm -rf $(BETA_DIR)/dist; \
	fi
	@echo "âœ… AufrÃ¤umen abgeschlossen!"

# Development Workflow
workflow: clean install build dev

# GitHub Storage Management
storage-check:
	@echo "ğŸ“Š PrÃ¼fe GitHub Storage-Nutzung..."
	chmod +x $(DEV_DIR)/manage-storage.sh
	cd $(DEV_DIR) && ./manage-storage.sh

storage-cleanup:
	@echo "ğŸ§¹ Starte GitHub Storage-Bereinigung..."
	chmod +x $(DEV_DIR)/manage-storage.sh
	cd $(DEV_DIR) && ./manage-storage.sh